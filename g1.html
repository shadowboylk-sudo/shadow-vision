<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Travel Blog Modern — Upload</title>
  <style>
    /* Reset & fonts */
    * { box-sizing: border-box; margin:0; padding:0; font-family: "Poppins", Arial, sans-serif; }
    body { background:#0f0f10; color:#111; }

    /* NAV / TOP BAR */
    nav.topbar {
      position: fixed; left:0; right:0; top:0;
      height:64px; display:flex; align-items:center; justify-content:space-between;
      padding: 0 20px; background: rgba(0,0,0,0.55); backdrop-filter: blur(6px);
      z-index: 20; color: white;
    }
    .brand { display:flex; align-items:center; gap:14px; }
    .brand h1 { font-size:1.6rem; color:#fff; margin-right:6px; letter-spacing:1px; }
    .brand p { font-size:0.85rem; color:#ddd; margin-top:4px; }

    /* Upload controls */
    .upload-controls { display:flex; gap:12px; align-items:center; }
    .file-input {
      position: relative; overflow:hidden; display:inline-block;
    }
    .file-input input[type=file]{
      position:absolute; left:0; top:0; opacity:0; width:100%; height:100%; cursor:pointer;
    }
    button.btn {
      background: linear-gradient(135deg,#1e88e5,#1565c0);
      color:white; border:none; padding:10px 16px; border-radius:12px;
      box-shadow: 0 6px 18px rgba(21,101,192,0.25);
      cursor:pointer; font-weight:600;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    button.btn:hover { transform: translateY(-3px); box-shadow: 0 14px 30px rgba(21,101,192,0.18); }
    .btn.secondary {
      background: linear-gradient(135deg,#fff,#f0f0f0); color:#111; padding:9px 14px; font-weight:600;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }

    /* Page layout */
    header.hero {
      height: 42vh; background: url('https://via.placeholder.com/1600x600') center/cover no-repeat;
      display:flex; align-items:center; justify-content:center; text-align:center; color:white;
      margin-top:64px; position:relative;
      text-shadow: 0 6px 20px rgba(0,0,0,0.6);
    }
    header.hero .hero-inner { max-width:1100px; padding: 30px; }
    header.hero h2 { font-size:3.2rem; margin-bottom:8px; }
    header.hero p { font-size:1.1rem; opacity:0.95; }

    /* preview thumbnail at top-left */
    #topPreview {
      position:absolute; left:24px; top:18px; width:80px; height:80px; object-fit:cover;
      border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.45); border:3px solid rgba(255,255,255,0.08);
      display:none;
      z-index: 6;
    }

    /* container */
    .container { width:90%; max-width:1200px; margin: 30px auto; padding-bottom:60px; }

    .post-card {
      background:#fff; border-radius:12px; padding:22px; box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      margin-bottom:26px; color:#111;
    }
    .post-card h3 { font-size:1.5rem; margin-bottom:10px; }
    .post-card p { font-size:1rem; color:#333; }

    /* gallery */
    .gallery { margin-top:10px; }
    .gallery h3 { color:#fff; margin-bottom:14px; font-size:1.25rem; }
    .grid { display:grid; grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); gap:14px; }
    .grid .cell {
      background: rgba(255,255,255,0.03); border-radius:10px; min-height:140px;
      display:flex; align-items:center; justify-content:center; padding:10px; position:relative;
    }
    .grid img { width:100%; height:100%; object-fit:cover; border-radius: 8px; display:block; }

    /* preview large */
    #preview {
      display:none; margin: 14px 0; width:100%; border-radius:10px; box-shadow: 0 8px 26px rgba(0,0,0,0.36);
    }

    /* status */
    #status { margin-left:8px; color:#fff; font-size:0.95rem; opacity:0.95; }

    /* mobile */
    @media (max-width:800px){
      header.hero h2 { font-size:2rem; }
      nav.topbar { padding: 0 12px; }
    }

    /* footer */
    footer { text-align:center; padding:18px; color:#ddd; background:#171717; margin-top:40px; }
  </style>
</head>
<body>
  <nav class="topbar">
    <div class="brand">
      <img id="topPreview" src="" alt="Uploaded preview">
      <div>
        <h1>My Travel Blog</h1>
        <p style="margin-top:4px;font-size:0.85rem;color:#ddd;">Discover My Adventures & Stories</p>
      </div>
    </div>
    <div class="upload-controls">
      <label class="file-input btn secondary" title="Choose photo">Choose photo <input id="fileInput" type="file" accept="image/*"></label> <button id="uploadBtn" class="btn">Upload</button> <button id="clearBtn" class="btn secondary" title="Clear preview">Clear</button> <span id="status" aria-live="polite"></span>
    </div>
  </nav>
  <header class="hero">
    <div class="hero-inner">
    <h2>My Travel Blog</h2>
    <p>Discover My Adventures & Stories</p><img id="preview" src="" alt="Uploaded preview large"></div>
  </header>
  <div class="container">
    <section class="post-card">
      <h3>Exploring Ella, Sri Lanka</h3>
      <p>Ella is one of the most beautiful and peaceful places in Sri Lanka. With stunning mountain views, waterfalls, and cool weather, it's a paradise for travelers.</p>
    </section>
    <section class="gallery">
      <h3 style="color:#fff;">Photo Gallery</h3>
      <div class="grid" id="galleryGrid">
        <div class="cell"><img src="https://via.placeholder.com/350x200?text=Photo+1" alt="350x200"></div>
        <div class="cell"><img src="https://via.placeholder.com/350x200?text=Photo+2" alt="350x200"></div>
        <div class="cell"><img src="https://via.placeholder.com/350x200?text=Photo+3" alt="350x200"></div>
        <div class="cell"><img src="https://via.placeholder.com/350x200?text=Photo+4" alt="350x200"></div>
      </div>
    </section>
  </div>
  <footer>
    © 2025 My Travel Blog
  </footer>
  <script type="module">
    // Firebase SDK imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getStorage, ref, uploadBytes, getDownloadURL } 
      from "https://www.gstatic.com/firebasejs/12.6.0/firebase-storage.js";

    // Your firebaseConfig (from your project settings)
    const firebaseConfig = {
      apiKey: "AIzaSyC83BuHC073-tAGSSPvPlRs904UrCMEeT0",
      authDomain: "storage-69547.firebaseapp.com",
      projectId: "storage-69547",
      storageBucket: "storage-69547.appspot.com",
      messagingSenderId: "122473493114",
      appId: "1:122473493114:web:972c94c342fee94dde35ad3",
      measurementId: "G-ZVP1JSPRRC"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const storage = getStorage(app);

    // Elements
    const fileInput = document.getElementById('fileInput');
    const uploadBtn = document.getElementById('uploadBtn');
    const clearBtn = document.getElementById('clearBtn');
    const statusEl = document.getElementById('status');
    const preview = document.getElementById('preview');
    const topPreview = document.getElementById('topPreview');
    const galleryGrid = document.getElementById('galleryGrid');

    let selectedFile = null;

    fileInput.addEventListener('change', (e) => {
      selectedFile = e.target.files[0] || null;
      if (!selectedFile) {
        preview.style.display = 'none';
        topPreview.style.display = 'none';
        statusEl.textContent = '';
        return;
      }
      // show local preview immediately (before upload)
      const localUrl = URL.createObjectURL(selectedFile);
      preview.src = localUrl;
      preview.style.display = 'block';
      topPreview.src = localUrl;
      topPreview.style.display = 'block';
      statusEl.textContent = 'Ready to upload: ' + selectedFile.name;
    });

    clearBtn.addEventListener('click', () => {
      fileInput.value = '';
      selectedFile = null;
      preview.style.display = 'none';
      topPreview.style.display = 'none';
      statusEl.textContent = 'Cleared';
    });

    uploadBtn.addEventListener('click', async () => {
      if (!selectedFile) {
        alert('Please choose a file first.');
        return;
      }
      try {
        statusEl.textContent = 'Uploading...';
        uploadBtn.disabled = true;

        // create a unique filename to avoid clashes
        const timestamp = Date.now();
        const safeName = timestamp + '_' + selectedFile.name.replace(/\s+/g,'_');
        const storageRef = ref(storage, 'uploads/' + safeName);

        // upload
        const snapshot = await uploadBytes(storageRef, selectedFile);

        // get public URL
        const url = await getDownloadURL(snapshot.ref);

        // update UI
        statusEl.textContent = 'Uploaded: ' + url;
        preview.src = url; preview.style.display = 'block';
        topPreview.src = url; topPreview.style.display = 'block';

        // append image to gallery as a new cell
        const cell = document.createElement('div');
        cell.className = 'cell';
        const img = document.createElement('img');
        img.src = url;
        img.alt = selectedFile.name;
        cell.appendChild(img);
        // insert at beginning
        galleryGrid.insertBefore(cell, galleryGrid.firstChild);

        // free local object URL if we created one earlier
        try { URL.revokeObjectURL(preview.src); } catch(e) {}

      } catch (err) {
        console.error(err);
        statusEl.textContent = 'Upload error: ' + (err.message || err);
        alert('Upload failed. Check Firebase Storage rules and console for details.');
      } finally {
        uploadBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
